# $2.11BSD_X44: Makefile.inc,v 1.0 2026/01/20 19:16:45 martin Exp $

WARNS= 4

.include <bsd.own.mk>

BINDIR?= /usr/bin

TCSHDIR=  ${NETBSDSRCDIR}/contrib/tcsh
TCSHDIST= ${TCSHDIR}/dist
TCSHINC=  ${TCSHDIR}/include

PROG= gethost
GENSRCS= gethost.c
GENHDRS= sh.err.h tc.const.h sh.h

SRCS+= ${GENHDRS} ${GENSRCS}

DFLAGS= -D_PATH_TCSHELL='"/bin/${PROG}"'

CPPFLAGS+= -I. -I${.CURDIR} ${DFLAGS}
CPPFLAGS+= -I${TCSHDIST}
CPPFLAGS+= -I${TCSHINC}

.PATH: ${TCSHDIST}
.PATH: ${TCSHINC}

sh.err.h: sh.err.c
	${_MKTARGET_CREATE}
	rm -f ${.TARGET}
	echo '/* Do not edit this file, make creates it. */' > ${.TARGET}
	echo '#ifndef _h_sh_err' >> ${.TARGET}
	echo '#define _h_sh_err' >> ${.TARGET}
	egrep 'ERR_' ${.ALLSRC} | egrep '^#define' >> ${.TARGET}
	echo '#endif /* _h_sh_err */' >> ${.TARGET}

tc.const.h: tc.const.c sh.char.h config.h config_f.h sh.types.h sh.err.h
	${_MKTARGET_CREATE}
	rm -f ${.TARGET}
	echo '/* Do not edit this file, make creates it. */' > ${.TARGET}
	echo '#ifndef _h_tc_const' >> ${.TARGET}
	echo '#define _h_tc_const' >> ${.TARGET}
	${CC} -E ${CPPFLAGS} ${.ALLSRC} -D_h_tc_const | egrep 'Char STR' | \
	    ${TOOL_SED} -e 's/Char \([a-zA-Z0-9_]*\)\(.*\)/extern Char \1[];/' | \
	    sort >> ${.TARGET}
	echo '#endif /* _h_tc_const */' >> ${.TARGET}

.include <bsd.prog.mk>
